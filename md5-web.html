<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>D·ªØ li·ªáu MD5</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css">
  <link rel="stylesheet" href="page.css">
  <style>
	.tabs {
      display: flex;
      margin-bottom: 10px;
    }
    .tab {
      padding: 10px 20px;
      border: 1px solid #ccc;
      border-bottom: none;
      background-color: #f1f1f1;
      cursor: pointer;
      margin-right: 5px;
    }
    .tab.active {
      background-color: white;
      font-weight: bold;
      border-top: 3px solid #007BFF;
    }
    .tab-content {
      border: 1px solid #ccc;
      padding: 15px;
      display: none;
    }
    .tab-content.active {
      display: block;
    }
	
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #888;
      padding: 6px 12px;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    #status, #statusReport {
      white-space: pre-line;
      margin-top: 10px;
      font-family: monospace;
      color: #333;
    }
	
	.today-code {
	  background-color: #d0f0ff;
	  padding: 2px 4px;
	  border-radius: 3px;
	}
	body { font-family: Arial; margin: auto; padding: 20px; padding-left: 50px}
    button { padding: 10px 20px; font-size: 16px; margin-right: 10px; }
    #resultAI { font-size: 18px; margin-top: 20px; font-weight: bold; }
	
	.container {
		display: flex;
		gap: 10px; /* Kho·∫£ng c√°ch gi·ªØa 2 c·ªôt */
		margin-top: 15px;
	  }

	.column {
		flex: 1; /* M·ªói c·ªôt chi·∫øm ƒë·ªÅu chi·ªÅu r·ªông */
		border: 1px solid #ccc;
		padding: 10px;
		box-sizing: border-box;
	}
  </style>
</head>
<body class="bg-gray-100 p-4">
	
	<div class="tabs">
	  <div class="tab" onclick="openTab('summary')">T·ªïng h·ª£p d·ªØ li·ªáu</div>
	  <div class="tab" onclick="openTab('vitural')">Gi·∫£ l·∫≠p</div>
	  <div class="tab" onclick="openTab('report')">Th·ªëng k√™</div>
	  <div class="tab active" onclick="openTab('auto')">Auto 1</div>
	  <div class="tab" onclick="openTab('autoFake')">Gi·∫£ l·∫≠p Auto 1</div>
	  <div class="tab" onclick="openTab('noteTab')">Ghi ch√∫</div>
	</div>
  
	<div id="summary" class="tab-content">
		<button onclick="getAllRecords(1)">H√¥m nay</button>
		<button onclick="getAllRecords(2)">H√¥m qua</button>
		<button onclick="getAllRecords24h()">24h qua</button>
		<button onclick="getAllRecords(3)">1 Tu·∫ßn qua</button>
		<button onclick="groupByMinute(3)">Theo gi·ªù</button>		
		<p id="output">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
		<p id="status">T·∫£i d·ªØ li·ªáu...</p>
	</div>
	
	<div id="noteTab" class="tab-content">
	  <h1>C√¥ng th·ª©c t√≠nh: </h1>
	  <h2>Chu·∫©n: </h2>
	  <p>S·ªë ti·ªÅn v√† s·ªë l·∫∑p l·∫•y theo gi√° tr·ªã nh·∫≠p v√†o. V√≠ d·ª• nh·∫≠p v√†o s·ªë ti·ªÅn 1000 v√† s·ªë l·∫∑p 70 th√¨ sau 70 l∆∞·ª£t s·ªë ti·ªÅn s·∫Ω nh√¢n ƒë√¥i</p>
	  
	  <h2>Gi·ªØ v·ªën: </h2>
	  <p>M·∫∑c ƒë·ªãnh s·ªë ti·ªÅn l√† 1000</p>
	  <p>M·∫∑c ƒë·ªãnh s·ªë l·∫∑p 70</p>
	  <p>T·ª´ l∆∞·ª£t 210-300 m·∫∑c ƒë·ªãnh l√† 1000</p>
	  <p>T·ª´ l∆∞·ª£t 300-370 m·∫∑c ƒë·ªãnh l√† 8000</p>
	  <p>T·ª´ l∆∞·ª£t 370-440 m·∫∑c ƒë·ªãnh l√† 16000</p>
	  <p>T·ª´ l∆∞·ª£t 440-510 m·∫∑c ƒë·ªãnh l√† 32000</p>
	  <p>T·ª´ 510 m·∫∑c ƒë·ªãnh l√† 1000</p>
	  
	  <h2>H√™n xui: </h2>
	  <p>M·∫∑c ƒë·ªãnh s·ªë ti·ªÅn l√† 1000</p>
	  <p>M·∫∑c ƒë·ªãnh s·ªë l·∫∑p b·∫±ng gi√° tr·ªã nh·∫≠p v√†o (ƒëang m·∫∑c ƒë·ªãnh l√† 70)</p>
	  <p>T·ª´ l∆∞·ª£t 210 (ho·∫∑c s·ªë l·∫∑p X 3) s·∫Ω chuy·ªÉn sang c√¥ng th·ª©c h√™n xui</p>
	  <p>H√™n xui: n·∫øu l∆∞·ª£t ch·∫µn th√¨ s·ªë ti·ªÅn v·∫´n l√† c·∫•p s·ªë nh√¢n b√¨nh th∆∞·ªùng (v√≠ d·ª• l∆∞·ª£t 212 ƒëang l√† 8000 th√¨ s·ªë ti·ªÅn l√† 8000)</p>
	  <p>H√™n xui: n·∫øu l∆∞·ª£t l·∫ª th√¨ s·ªë ti·ªÅn 1000</p>
	</div>
	
	<div id="vitural" class="tab-content">
		<div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
		  <h3>Nh·∫≠p th√¥ng tin</h3>
		  <label>S·ªë c·∫ßn ƒë√°nh (c√°ch nhau b·∫±ng d·∫•u ph·∫©y):</label><br>
		  <input type="text" id="numbers" value="90"><br>

		  <label>S·ªë ti·ªÅn b·∫Øt ƒë·∫ßu:</label><br>
		  <input type="number" id="startMoney" value="1000"><br>

		  <label>L·∫∑p l·∫°i:</label><br>
		  <input type="number" id="loop" value="40"><br><br>

		  <button onclick="runVirtual()">Ch·∫°y m√¥ ph·ªèng</button>
		</div>
	  <pre id="outputVitural" style="font-family: Arial, sans-serif; font-size: 16px; color: #222;"></pre>
	</div>
	
	<div id="report" class="tab-content">
		<button onclick="groupByDate()">Ph√¢n t√≠ch</button>
		<button onclick="toogle('groupByDateOutputCol')">X√°c su·∫•t nhi·ªÅu nh·∫•t</button>
		<button onclick="toogle('calculateStd1440Col')">H·ªá s·ªë bi·∫øn thi√™n 1440</button>
		<button onclick="toogle('calculateStdTrust1440Col')">S·ªë l∆∞·ª£t v·ªÅ 6 ng√†y qua</button>
		<div class="container">
		  <div id="groupByDateOutputCol" class="column">
			<h3>X√°c su·∫•t nhi·ªÅu nh·∫•t</h3>
			<p id="groupByDateOutput">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
			<p id="groupByDateStatus">T·∫£i d·ªØ li·ªáu...</p>
		  </div>
		  <div id="calculateStd1440Col" class="column">
			<h3>H·ªá s·ªë bi·∫øn thi√™n 1440</h3>
			<p id="calculateStd1440Output">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
			<p id="calculateStd1440Status">T·∫£i d·ªØ li·ªáu...</p>
		  </div>
		  <div id="calculateStdTrust1440Col" class="column">
			<h3>S·ªë l∆∞·ª£t v·ªÅ 6 ng√†y qua</h3>
			<p id="calculateStdTrust1440Output">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
			<p id="calculateStdTrust1440Status">T·∫£i d·ªØ li·ªáu...</p>
		  </div>
		</div>
	</div>
	
	<div id="auto" class="tab-content active">
	  <h1 class="text-2xl font-bold mb-6">Number Selector</h1>
	  
	  <div class="main-container">
	  <!-- Danh s√°ch s·ªë 00-99 (10 h√†ng x 10 c·ªôt) -->
	  <div id="numberList" class="mb-6 space-y-2"></div>

	  <!-- Danh s√°ch s·ªë ƒë√£ ch·ªçn -->
	  <div class="mb-6" id="selectedContainer">
		<h2 class="font-semibold text-lg mb-2">Danh s√°ch s·ªë ƒë√£ ch·ªçn</h2>
		<table class="w-full border text-center">
		  <thead>
			<tr class="bg-gray-200">
			  <th class="border p-2 w-16">S·ªë</th>
			  <th class="border p-2 w-28">S·ªë ti·ªÅn</th>
			  <th class="border p-2 w-28">S·ªë l∆∞·ª£t</th>
			  <th class="border p-2">S·ªë d·ª± ph√≤ng</th>
			</tr>
		  </thead>
		  <tbody id="selectedNumbers"></tbody>
		</table>
		
		<!-- √¥ nh·∫≠p s·ªë ti·ªÅn mong mu·ªën -->
		<div class="desired-money-container">
		  <label for="desiredMoney">üí∞ S·ªë ti·ªÅn mong mu·ªën:</label>
		  <input type="number" id="desiredMoney" min="1" value="500000">
		</div>
		
		<!-- √î nh·∫≠p Username / Password -->
		<div class="login-container">
		  <label>Username</label>
		  <input type="text" id="username" placeholder="Username">
		</div>
		<div class="login-container">
		  <label>Password</label>
		  <input type="password" id="password" placeholder="Password"> <br>
		</div>
		<div class="login-container">
		  <label>Token</label>
		  <input type="text" id="token" placeholder="Token">
		</div>
		
		<!-- C√¥ng th·ª©c t√≠nh -->
		<div class="radio-group-wrapper">
		  <label class="radio-group-label">Ch·ªçn c√¥ng th·ª©c:</label>
		  <div id="betTypeGroup" class="radio-group">
			<label>
			  <input type="radio" name="betType" value="1" checked>
			  <span>Chu·∫©n</span>
			</label>
			<label>
			  <input type="radio" name="betType" value="2">
			  <span>Gi·ªØ v·ªën</span>
			</label>
			<label>
			  <input type="radio" name="betType" value="3">
			  <span>H√™n xui</span>
			</label>
			<label>
			  <input type="radio" name="betType" value="4">
			  <span>∆Øu ti√™n</span>
			</label>
		  </div>
		</div>
		
		<div id="messageAuto">
		</div>
		
		<!-- N√∫t ƒëi·ªÅu khi·ªÉn -->
		<div id="runningIndicator">
		  <div class="running-dot"></div>
		  <span>ƒêang ch·∫°y...</span>
		</div>
		
		<!-- N√∫t ƒëi·ªÅu khi·ªÉn -->
		<div class="flex gap-4 mb-6">
		  <button id="startBtn" class="btn btn-start">‚ñ∂ Start</button>
		  <button id="startBtn1" class="btn btn-start">‚ñ∂ Start 1</button>
		  <button id="stopBtn" class="btn btn-stop">‚ñ† Stop</button>
		  <button id="updateBtn" class="btn btn-update">‚ñ∂ D·ª± ph√≤ng</button>
		</div>
	  </div>
	  
	  </div>
	 
	  <!-- Log -->
	  <div class="log-container">
		<div class="log-box" style="flex: 0.6">
		  <h3 class="font-semibold mb-2">Log c√¥ng vi·ªác</h3>
		  <pre id="logArea"></pre>
		</div>
		<div class="log-box">
		  <h3 class="font-semibold mb-2">Log k·∫øt qu·∫£ ƒë√∫ng</h3>
		  <pre id="successLog"></pre>
		</div>
	  </div>
	  <audio id="successSound" src="win.mp3" preload="auto" hidden></audio>
	  <script src="page.js"></script>
	</div>
	
	<!-- Auto fake-->
	<div id="autoFake" class="tab-content">
	  <button id="autoFakeBtn" class="btn btn-stop">Run fake</button>
	  <div class="container">
	    <p id="autoFakeResult"></p>
	  </div>
	  <script src="runfake.js"></script>
	</div>
  <script>
  
   const apiBaseUrl = "https://api.vgjt.info/ldmd5/games/1/results";

	function toogle(id) {
		const div = document.getElementById(id);
		if (div.style.display === "none") {
		  div.style.display = "block";
		} else {
		  div.style.display = "none";
		}
	}
	
	
	//T√≠nh ƒë·ªô l·ªách chu·∫©n
	async function calculateStdTrust1440(records) {
		//let records = await findAll(3, "calculateStdTrust1440Status", "calculateStdTrust1440Output");

		// B∆∞·ªõc 1: S·∫Øp x·∫øp theo `code` tƒÉng d·∫ßn
		//records.sort((a, b) => a.code.localeCompare(b.code));
		
		// B∆∞·ªõc 2: Gom nh√≥m theo ng√†y (ph·∫ßn tr∆∞·ªõc d·∫•u g·∫°ch n·ªëi trong `code`)
		const groupedSpecials = {};
	
		records.forEach(item => {
		  const date = item.code.split("-")[0];
		  const special = item.result.special;
		  const last2 = parseInt(special.slice(-2), 10);

		  if (!groupedSpecials[date]) {
			groupedSpecials[date] = [];
		  }

		  groupedSpecials[date].push(last2);
		});
		
		// T√¨m ng√†y m·ªõi nh·∫•t
		const latestDate = Object.keys(groupedSpecials).sort().pop();

		// X√≥a ng√†y ƒë√≥
		delete groupedSpecials[latestDate];
		
		const days = Object.keys(groupedSpecials);
		const totalDays = days.length;

		// T·∫°o m·∫£ng 100 ph·∫ßn t·ª≠, m·ªói ph·∫ßn t·ª≠ l√† m·∫£ng l·ªãch s·ª≠ xu·∫•t hi·ªán theo ng√†y
		const history = Array.from({ length: 100 }, () => []);

		// Ghi nh·∫≠n s·ªë l·∫ßn xu·∫•t hi·ªán m·ªói ng√†y
		days.forEach(day => {
		  const nums = groupedSpecials[day];
		  for (let i = 0; i < 100; i++) {
			const count = nums.filter(n => n === i).length;
			history[i].push(count);
		  }
		});
		
		// T·∫°o danh s√°ch s·ªë v√† ƒë·ªô l·ªách chu·∫©n
		console.log('ƒê·ªô tin c·∫≠y 1440 - B·∫ÆT ƒê·∫¶U ===============');
		let result = '';
		const stdList = history
		  .map((arr, num) => {
			console.log("s·ªë: " + num + "----- ƒë√£ v·ªÅ c√°c ng√†y: " + arr);
			
			result += `<b>S·ªë ${num}</b>: ${arr}<br><br>`;
			
			const total = arr.reduce((a, b) => a + b, 0);
			if (total === 0) return null; // b·ªè qua s·ªë ch∆∞a t·ª´ng xu·∫•t hi·ªán
			return { number: num, std: calculateStdTrustTemp(arr) };
		  });
		  //.filter(Boolean)
		  //.sort((a, b) => a.std - b.std); // tƒÉng d·∫ßn theo ƒë·ªô l·ªách chu·∫©n
		  //.slice(0, 10); // l·∫•y 10 s·ªë ƒë·∫ßu ti√™n
		console.log('ƒê·ªô tin c·∫≠y 1440 - K·∫æT TH√öC ===============');
		
		document.getElementById('calculateStdTrust1440Output').innerHTML = result;
	}
	
	//T√≠nh ƒë·ªô l·ªách chu·∫©n 1440
	async function calculateStd1440(records) {
		//let records = await findAll(3, "calculateStd1440Status", "calculateStd1440Output");

		// B∆∞·ªõc 1: S·∫Øp x·∫øp theo `code` tƒÉng d·∫ßn
		//records.sort((a, b) => a.code.localeCompare(b.code));
		
		// B∆∞·ªõc 2: Gom nh√≥m theo ng√†y (ph·∫ßn tr∆∞·ªõc d·∫•u g·∫°ch n·ªëi trong `code`)
		const groupedSpecials = {};
		
		records.forEach(item => {
		  const date = item.code.split("-")[0];
		  const special = item.result.special;
		  const last2 = parseInt(special.slice(-2), 10);

		  if (!groupedSpecials[date]) {
			groupedSpecials[date] = [];
		  }

		  groupedSpecials[date].push(last2);
		});
		
		// T√¨m ng√†y m·ªõi nh·∫•t
		const latestDate = Object.keys(groupedSpecials).sort().pop();

		// X√≥a ng√†y ƒë√≥
		delete groupedSpecials[latestDate];
		
		const days = Object.keys(groupedSpecials);
		const totalDays = days.length;

		// T·∫°o m·∫£ng 100 ph·∫ßn t·ª≠, m·ªói ph·∫ßn t·ª≠ l√† m·∫£ng l·ªãch s·ª≠ xu·∫•t hi·ªán theo ng√†y
		const history = Array.from({ length: 100 }, () => []);

		// Ghi nh·∫≠n s·ªë l·∫ßn xu·∫•t hi·ªán m·ªói ng√†y
		days.forEach(day => {
		  const nums = groupedSpecials[day];
		  for (let i = 0; i < 100; i++) {
			const count = nums.filter(n => n === i).length;
			history[i].push(count);
		  }
		});
		
		console.log('H·ªá s·ªë bi·∫øn thi√™n 1440 - B·∫ÆT ƒê·∫¶U ===============');
		// T·∫°o danh s√°ch s·ªë v√† ƒë·ªô l·ªách chu·∫©n
		const stdList = history
		  .map((arr, num) => {
			console.log("s·ªë: " + num + "----- ƒë√£ v·ªÅ c√°c ng√†y: " + arr);
			const total = arr.reduce((a, b) => a + b, 0);
			if (total === 0) return null; // b·ªè qua s·ªë ch∆∞a t·ª´ng xu·∫•t hi·ªán
			return { number: num, std: calculateStdTemp(arr) };
		  })
		  .filter(Boolean)
		  .sort((a, b) => a.std - b.std); // tƒÉng d·∫ßn theo ƒë·ªô l·ªách chu·∫©n
		  //.slice(0, 10); // l·∫•y 10 s·ªë ƒë·∫ßu ti√™n
		
		console.log('H·ªá s·ªë bi·∫øn thi√™n 1440 - K·∫æT TH√öC ===============');
		let result = '';
		stdList.forEach(item => {
			result += `<b>S·ªë ${item.number}</b>: ƒê·ªô l·ªách chu·∫©n = ${item.std.toFixed(2)}<br><br>`;
		});
		
		document.getElementById('calculateStd1440Output').innerHTML = result;
	}
	
	// T√≠nh ƒë·ªô tin c·∫≠y cho m·ªói s·ªë
    function calculateStdTrustTemp(arr) {
      const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
      const variance = arr.reduce((sum, val) => sum + (val - mean) ** 2, 0) / (arr.length - 1);
      const finalRst = Math.sqrt(variance);
	  const start = Math.floor(Math.abs(mean - finalRst));
	  const end = Math.floor(Math.abs(mean + finalRst))
	  return getPositiveIntegersBetween(start, end);
    }
	
	// T√≠nh ƒë·ªô l·ªách chu·∫©n cho m·ªói s·ªë
    function calculateStdTemp(arr) {
      const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
      const variance = arr.reduce((sum, val) => sum + (val - mean) ** 2, 0) / (arr.length - 1);
      const finalRst = Math.sqrt(variance) / mean * 100;
	  return finalRst;
    }
	
	function getPositiveIntegersBetween(a, b) {
	  const start = Math.ceil(Math.min(a, b));
	  const end = Math.floor(Math.max(a, b));
	  const result = [];

	  for (let i = start + 1; i < end; i++) {
		if (i > 0) result.push(i); // ch·ªâ l·∫•y s·ªë nguy√™n d∆∞∆°ng
	  }

	  return result;
	}
	
	//T√≠nh x√°c su·∫•t v·ªÅ nhi·ªÅu nh·∫•t
	async function groupByDate() {
		const records = await findAll(3, "groupByDateStatus", "groupByDateOutput");

		// B∆∞·ªõc 1: S·∫Øp x·∫øp theo `code` tƒÉng d·∫ßn
		records.sort((a, b) => a.code.localeCompare(b.code));
		
		const clone3 = structuredClone(records);
		const clone4 = structuredClone(records);
		calculateStd1440(clone3);
		calculateStdTrust1440(clone4);

		// B∆∞·ªõc 2: Gom nh√≥m theo ng√†y (ph·∫ßn tr∆∞·ªõc d·∫•u g·∫°ch n·ªëi trong `code`)
		const groupedSpecials = {};

		records.forEach(item => {
		  const date = item.code.split("-")[0];
		  const special = item.result.special;
		  const last2 = parseInt(special.slice(-2), 10);

		  if (!groupedSpecials[date]) {
			groupedSpecials[date] = [];
		  }

		  groupedSpecials[date].push(last2);
		});
		
		 let allNumbers = [];

		// Gom t·∫•t c·∫£ c√°c s·ªë l·∫°i th√†nh m·ªôt m·∫£ng l·ªõn
		Object.values(groupedSpecials).forEach(arr => {
		  allNumbers = allNumbers.concat(arr);
		});

		const totalCount = allNumbers.length;
		const freq = Array(100).fill(0);

		// ƒê·∫øm t·∫ßn su·∫•t xu·∫•t hi·ªán c·ªßa t·ª´ng s·ªë t·ª´ 0 ƒë·∫øn 99
		allNumbers.forEach(num => {
		  if (num >= 0 && num < 100) freq[num]++;
		});

		const predictLength = 200; // s·ªë l∆∞·ª£t c·∫ßn d·ª± ƒëo√°n
		const topK = 100;

		// T√≠nh x√°c su·∫•t v√† s·∫Øp x·∫øp
		const predictions = freq.map((count, num) => ({
		  number: num,
		  expected: +(count / totalCount * predictLength).toFixed(2)
		})).sort((a, b) => b.expected - a.expected);

		// Hi·ªÉn th·ªã k·∫øt qu·∫£
		const output = predictions.slice(0, topK)
		  .map((p, i) => `${i + 1}. S·ªë ${p.number} ‚Üí D·ª± ƒëo√°n xu·∫•t hi·ªán: ${p.expected} l·∫ßn \n`)
		  .join('\n');
		  
		 document.getElementById('groupByDateOutput').innerText = output;
	}
	
	//Gi·∫£ l·∫≠p
	function runVirtual() {
		let output = '';
		for (let i = 1; i < 101; i++) {
			output += print();
		}
		document.getElementById("outputVitural").innerText = output;
	}
	
	function print() {
	  const formatter = new Intl.NumberFormat('en-US', {
		style: 'currency',
		currency: 'USD',
		minimumFractionDigits: 0,
		maximumFractionDigits: 0
	  });
	  
	  let output = '';
	  
	  const numbers = document.getElementById("numbers").value.split(',').map(n => parseInt(n.trim()));
      const startMoney = parseInt(document.getElementById("startMoney").value);
      const loop = parseInt(document.getElementById("loop").value);

	  const map = new Map();
	  initNumberInfo(numbers, startMoney, map);

	  let month = 1200;
	  const totalDays = month * 30;
	  let totalMoney = 0;
	  let totalGet = 0;

	  for (let i = 1; i < totalDays; i++) {
		if (map.size === 0) {
		  break;
		}

		totalMoney += totalMonney(map); // totalMonney c·∫ßn ƒë∆∞·ª£c vi·∫øt th√™m

		const rdNumber = Math.floor(Math.random() * 100);
		for (const info of map.values()) {
		  let count = info.count;
		  if (count % loop === 0) {
			info.money *= 2;
		  }
		  info.count = count + 1;
		}

		let matched = -1;
		for (const number of numbers) {
		  if (rdNumber === number) {
			const info = map.get(number);
			if (info) {
			  totalGet += info.money * 98;
			  output += `Tr√∫ng th∆∞·ªüng: L∆∞·ª£t ${i} -- ti·ªÅn c∆∞·ª£c ${formatter.format(info.money)} -- t·ªïng th∆∞·ªüng: ${formatter.format(totalGet)} --- t·ªïng v·ªën: ${formatter.format(totalMoney)}\n`;
			  info.count = 1;
			  matched = number;
			}
			break;
		  }
		}

		if (matched > -1) {
		  map.delete(matched);
		  matched = -1;
		}
	  }

	  output += "---- T·ªïng ti·ªÅn thua: " + formatter.format(totalMoney) + "\n";
      output += "---- T·ªïng ti·ªÅn th·∫Øng: " + formatter.format(totalGet) + "\n";
      output += "========================================================================================================================================\n";
	  return output;
	}

	// H√†m kh·ªüi t·∫°o th√¥ng tin ban ƒë·∫ßu cho t·ª´ng s·ªë
	function initNumberInfo(numbers, startMoney, map) {
	  for (const number of numbers) {
		map.set(number, { money: startMoney, count: 1 });
	  }
	}

	// H√†m t√≠nh t·ªïng s·ªë ti·ªÅn hi·ªán t·∫°i trong map
	function totalMonney(map) {
	  let total = 0;
	  for (const info of map.values()) {
		total += info.money;
	  }
	  return total;
	}

	// L·∫•y d·ªØ li·ªáu
	
    async function getPage(type, page, size = 100) {
      const url = `${apiBaseUrl}?type=${type}&page=${page}&size=${size}`;
      const response = await fetch(url);
      if (!response.ok) throw new Error("L·ªói khi g·ªçi API trang " + page);
      const json = await response.json();
      return json;
    }

    async function getAllRecords(type) {
      const allRecords = [];
      const summary = {}; // A ‚Üí danh s√°ch code
      for (let i = 0; i < 100; i++) summary[i] = [];

      const pageSize = 100;
      let currentPage = 1;
      let totalPages = 1;
      let statusEl = document.getElementById("status");
      let tableContainer = document.getElementById("output");
      statusEl.innerText = "ƒêang t·∫£i d·ªØ li·ªáu...";

      try {
		tableContainer.innerHTML = "ƒêang t·∫£i d·ªØ li·ªáu";
        // Trang ƒë·∫ßu
        const firstPage = await getPage(type, currentPage, pageSize);
        allRecords.push(...firstPage.records);
        const totalRecords = firstPage.page.total;
        totalPages = Math.ceil(totalRecords / pageSize);

        statusEl.innerText = `üîÑ ƒêang t·∫£i ${totalRecords} records t·ª´ ${totalPages} trang...\n`;

        // C√°c trang ti·∫øp theo
        for (let page = 2; page <= totalPages; page++) {
          const pageData = await getPage(type, page, pageSize);
          allRecords.push(...pageData.records);
          statusEl.innerText += `‚úÖ Trang ${page}/${totalPages} - T·ªïng ${allRecords.length} records\n`;
        }

		statusEl.innerText += `‚úÖ T·∫£i xong ${totalRecords} records t·ª´ ${totalPages} trang...\n`;
		
		let arrays = "";
		console.log(allRecords);
        // T·ªïng h·ª£p
        allRecords.forEach(record => {
		
          const special = record.result.special;
		  arrays = arrays + "," + parseInt(special.slice(-2), 10);
          const code = record.code.slice(-4);
          const A = parseInt(special.slice(-2), 10);

          if (!isNaN(A)) {
            summary[A].push(code);
          }
        });

        // T·∫°o b·∫£ng
        let tableHTML = "<table> <thead><tr><th>S·ªë A</th><th>Danh s√°ch code</th></tr></thead><tbody>";

        for (let i = 0; i < 100; i++) {
          if (summary[i].length > 0) {
            tableHTML += "<tr><td>" + i + "</td><td>" + summary[i].join(', ') + "</td></tr>";
          }
        }

        tableHTML += "</tbody></table>";
        tableContainer.innerHTML = tableHTML;
        statusEl.innerText += `üéâ Ho√†n t·∫•t! T·ªïng c·ªông ${allRecords.length} records.`;
		return allRecords;
      } catch (err) {
        statusEl.innerText += `‚ùå L·ªói: ${err.message}`;
        console.error(err);
      }
	  return null;
    }
	
	async function findAll(type, divStatus, divOutput) {
      const allRecords = [];
      const summary = {}; // A ‚Üí danh s√°ch code
      for (let i = 0; i < 100; i++) summary[i] = [];

      const pageSize = 100;
      let currentPage = 1;
      let totalPages = 1;
      let statusEl = document.getElementById(divStatus);
      let tableContainer = document.getElementById(divOutput);
      statusEl.innerText = "ƒêang t·∫£i d·ªØ li·ªáu...";

      try {
		tableContainer.innerHTML = "K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...";
        // Trang ƒë·∫ßu
        const firstPage = await getPage(type, currentPage, pageSize);
        allRecords.push(...firstPage.records);
        const totalRecords = firstPage.page.total;
        totalPages = Math.ceil(totalRecords / pageSize);

        statusEl.innerText = `üîÑ ƒêang t·∫£i ${totalRecords} records t·ª´ ${totalPages} trang...\n`;

        // C√°c trang ti·∫øp theo
        for (let page = 2; page <= totalPages; page++) {
          const pageData = await getPage(type, page, pageSize);
          allRecords.push(...pageData.records);
          statusEl.innerText += `‚úÖ Trang ${page}/${totalPages} - T·ªïng ${allRecords.length} records\n`;
        }

		statusEl.innerText += `‚úÖ T·∫£i xong ${totalRecords} records t·ª´ ${totalPages} trang...\n`;
		
		let arrays = "";
		
        // T·ªïng h·ª£p
        allRecords.forEach(record => {
          const special = record.result.special;
		  arrays = arrays + "," + parseInt(special.slice(-2), 10);
          const code = record.code.slice(-4);
          const A = parseInt(special.slice(-2), 10);

          if (!isNaN(A)) {
            summary[A].push(code);
          }
        });
		return allRecords;
      } catch (err) {
        console.error(err);
      }
	  return null;
    }
	
	
	async function getAllRecords24h() {
      const allRecords = [];
	  const allRecordsTom = [];
      const summary = {}; // A ‚Üí danh s√°ch code
      for (let i = 0; i < 100; i++) summary[i] = [];

      const pageSize = 100;
      let currentPage = 1;
      let totalPages = 1;
      let statusEl = document.getElementById("status");
      let tableContainer = document.getElementById("output");
      statusEl.innerText = "ƒêang t·∫£i d·ªØ li·ªáu...";
		
	  let type = 1;
      try {
		tableContainer.innerHTML = "ƒêang t·∫£i d·ªØ li·ªáu";
        // Trang ƒë·∫ßu
        const firstPage = await getPage(type, currentPage, pageSize);
        allRecords.push(...firstPage.records);
        const totalRecords = firstPage.page.total;
        totalPages = Math.ceil(totalRecords / pageSize);

        statusEl.innerText = `üîÑ ƒêang t·∫£i ${totalRecords} records t·ª´ ${totalPages} trang...\n`;

        // C√°c trang ti·∫øp theo
        for (let page = 2; page <= totalPages; page++) {
          const pageData = await getPage(type, page, pageSize);
          allRecords.push(...pageData.records);
          statusEl.innerText += `‚úÖ Trang ${page}/${totalPages} - T·ªïng ${allRecords.length} records\n`;
        }
		
		type = 2;
		// Trang ƒë·∫ßu h√¥m qua
        const firstPage24h = await getPage(type, currentPage, pageSize);
        allRecordsTom.push(...firstPage24h.records);
        const totalRecords24h = firstPage24h.page.total;
        totalPages = Math.ceil(totalRecords24h / pageSize);

        statusEl.innerText = `üîÑ ƒêang t·∫£i ${totalRecords} records t·ª´ ${totalPages} trang...\n`;

        // C√°c trang ti·∫øp theo h√¥m qua
        for (let page = 2; page <= totalPages; page++) {
          const pageData = await getPage(type, page, pageSize);
          allRecordsTom.push(...pageData.records);
          statusEl.innerText += `‚úÖ Trang ${page}/${totalPages} - T·ªïng ${allRecordsTom.length} records\n`;
        }

        // T·ªïng h·ª£p h√¥m nay
        allRecords.forEach(record => {
          const special = record.result.special;
          const code = record.code.slice(-4);
          const A = parseInt(special.slice(-2), 10);

          if (!isNaN(A)) {
            summary[A].push(code);
          }
        });
		
		// T·ªïng h·ª£p h√¥m qua
		const now = Date.now();
		const last24hRecords = allRecordsTom.filter(record => {
		  const createdAt = new Date(record.result.date).getTime();
		  return (now - createdAt) <= 24 * 60 * 60 * 1000; // trong 24h
		});
		
        last24hRecords.forEach(record => {
          const special = record.result.special;
          const code = record.code.slice(-4);
          const A = parseInt(special.slice(-2), 10);

          if (!isNaN(A)) {
            summary[A].push(`<span class="today-code">${code}</span>`);
          }
        });

        // T·∫°o b·∫£ng
        let tableHTML = `<table>
            <thead>
              <tr><th>S·ªë A</th><th>Danh s√°ch code</th></tr>
            </thead>
            <tbody>`;

        for (let i = 0; i < 100; i++) {
          if (summary[i].length > 0) {
            tableHTML += `<tr>
              <td>${i}</td>
              <td>${summary[i].join(', ')}</td>
            </tr>`;
          }
        }

        tableHTML += `</tbody></table>`;
        tableContainer.innerHTML = tableHTML;
        statusEl.innerText += `üéâ Ho√†n t·∫•t! T·ªïng c·ªông ${allRecords.length} records.`;

      } catch (err) {
        statusEl.innerText += `‚ùå L·ªói: ${err.message}`;
        console.error(err);
      }
	}
    
	function openTab(tabId) {
	  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
	  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
	  document.querySelector(`.tab[onclick="openTab('${tabId}')"]`).classList.add('active');
	  document.getElementById(tabId).classList.add('active');
	}
	
	async function groupByMinute(type) {
	  
	  const allRecords = [];
      const summary = {}; // A ‚Üí danh s√°ch code
      for (let i = 0; i < 100; i++) summary[i] = [];

      const pageSize = 100;
      let currentPage = 1;
      let totalPages = 1;
      let statusEl = document.getElementById("status");
      let tableContainer = document.getElementById("output");
      statusEl.innerText = "ƒêang t·∫£i d·ªØ li·ªáu...";

      try {
        // Trang ƒë·∫ßu
        const firstPage = await getPage(type, currentPage, pageSize);
        allRecords.push(...firstPage.records);
        const totalRecords = firstPage.page.total;
        totalPages = Math.ceil(totalRecords / pageSize);

        statusEl.innerText = `üîÑ ƒêang t·∫£i ${totalRecords} records t·ª´ ${totalPages} trang...\n`;

        // C√°c trang ti·∫øp theo
        for (let page = 2; page <= totalPages; page++) {
          const pageData = await getPage(type, page, pageSize);
          allRecords.push(...pageData.records);
          statusEl.innerText += `‚úÖ Trang ${page}/${totalPages} - T·ªïng ${allRecords.length} records\n`;
        }

		statusEl.innerText += `‚úÖ T·∫£i xong ${totalRecords} records t·ª´ ${totalPages} trang...\n`;
		
        // T·ªïng h·ª£p
        
		// Gom d·ªØ li·ªáu theo ph√∫t
		  const grouped = {}; // { time: { date: number } }
		  const allDatesSet = new Set();

		  allRecords.forEach(item => {
			const code = item.code;
			const date = code.slice(0, 8);      // YYYYMMDD
			const time = item.result.date.slice(11, 16);     // HHMM
			const special = item.result.special;
			

			// L·∫•y 2 s·ªë cu·ªëi c·ªßa special
			let number = '';
			if (special && /^\d{5}$/.test(special)) {
				number = special.slice(-2); // L·∫•y 2 s·ªë cu·ªëi
			}

			allDatesSet.add(date);

			if (!grouped[time]) grouped[time] = {};
			grouped[time][date] = number;
		  });

		  // Danh s√°ch 1440 ph√∫t trong ng√†y
		  const allTimes = Array.from({ length: 1440 }, (_, i) => {
			const hour = String(Math.floor(i / 60)).padStart(2, '0');
			const minute = String(i % 60).padStart(2, '0');
			return hour + ":" + minute;
		  });

		  // Danh s√°ch ng√†y (gi·∫£m d·∫ßn)
		  const allDates = Array.from(allDatesSet).sort((a, b) => b.localeCompare(a));

		  // T·∫°o b·∫£ng HTML
		  let html = '<table border="1" cellpadding="4" cellspacing="0"><thead><tr>';
		  html += '<th>üïí Th·ªùi gian</th>';
		  allDates.forEach(date => {
			html += `<th>${formatDate(date)}</th>`;
		  });
		  html += '</tr></thead><tbody>';

		  allTimes.forEach(time => {
			html += `<tr><td>${time}</td>`;
			allDates.forEach(date => {
			  const value = grouped[time]?.[date] ?? '';
			  html += `<td>${value}</td>`;
			});
			html += '</tr>';
		  });

		  html += '</tbody></table>';
		  document.getElementById('output').innerHTML = html;
      } catch (err) {
        statusEl.innerText += `‚ùå L·ªói: ${err.message}`;
        console.error(err);
      }
	}

	// ƒê·ªãnh d·∫°ng "20250729" ‚Üí "29/07/2025"
	function formatDate(yyyymmdd) {
	  return `${yyyymmdd.slice(6, 8)}/${yyyymmdd.slice(4, 6)}/${yyyymmdd.slice(0, 4)}`;
	}

	// ƒê·ªãnh d·∫°ng "0001" ‚Üí "00:01"
	function formatTime(hhmm) {
	  return `${hhmm.slice(0, 2)}:${hhmm.slice(2)}`;
	}
	
	//Train AI
	let model;
	let todayResult;
  
    async function getPage(type, page, size = 100) {
      const url = `${apiBaseUrl}?type=${type}&page=${page}&size=${size}`;
      const response = await fetch(url);
      if (!response.ok) throw new Error("L·ªói khi g·ªçi API trang " + page);
      const json = await response.json();
      return json;
    }
	
  </script>
</body>
</html>
